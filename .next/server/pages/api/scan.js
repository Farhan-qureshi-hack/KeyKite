"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/scan";
exports.ids = ["pages/api/scan"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "simple-git":
/*!*****************************!*\
  !*** external "simple-git" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("simple-git");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fscan&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cscan.ts&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fscan&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cscan.ts&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_scan_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\scan.ts */ \"(api)/./pages/api/scan.ts\");\n// @ts-ignore this need to be imported from next/dist to be external\n\n\n\nconst PagesAPIRouteModule = next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule;\n// Import the userland code.\n// @ts-expect-error - replaced by webpack/turbopack loader\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_scan_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_scan_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/scan\",\n        pathname: \"/api/scan\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_scan_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnNjYW4mcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q3NjYW4udHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7QUFDMEY7QUFDM0I7QUFDTDtBQUMxRCw0QkFBNEIsZ0hBQTBCO0FBQ3REO0FBQ0E7QUFDa0Q7QUFDbEQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLCtDQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQywrQ0FBUTtBQUNwQztBQUNPO0FBQ1A7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9rZXlraXRlLz84YmYzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEB0cy1pZ25vcmUgdGhpcyBuZWVkIHRvIGJlIGltcG9ydGVkIGZyb20gbmV4dC9kaXN0IHRvIGJlIGV4dGVybmFsXG5pbXBvcnQgKiBhcyBtb2R1bGUgZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuY29uc3QgUGFnZXNBUElSb3V0ZU1vZHVsZSA9IG1vZHVsZS5QYWdlc0FQSVJvdXRlTW9kdWxlO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuLy8gQHRzLWV4cGVjdC1lcnJvciAtIHJlcGxhY2VkIGJ5IHdlYnBhY2svdHVyYm9wYWNrIGxvYWRlclxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXHNjYW4udHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9zY2FuXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc2NhblwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fscan&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cscan.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/scan.ts":
/*!***************************!*\
  !*** ./pages/api/scan.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! os */ \"os\");\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(os__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var simple_git__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! simple-git */ \"simple-git\");\n/* harmony import */ var simple_git__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(simple_git__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _utils_security__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/security */ \"(api)/./utils/security.ts\");\n// pages/api/scan.ts\n\n\n\n\n\nfunction walkDir(dir, exts = []) {\n    const out = [];\n    const items = fs__WEBPACK_IMPORTED_MODULE_2___default().readdirSync(dir);\n    for (const it of items){\n        const full = path__WEBPACK_IMPORTED_MODULE_1___default().join(dir, it);\n        try {\n            const st = fs__WEBPACK_IMPORTED_MODULE_2___default().statSync(full);\n            if (st.isDirectory()) {\n                out.push(...walkDir(full, exts));\n            } else if (st.isFile()) {\n                if (exts.length === 0 || exts.some((e)=>full.endsWith(e))) out.push(full);\n            }\n        } catch (e) {}\n    }\n    return out;\n}\nasync function handler(req, res) {\n    if (req.method !== \"POST\") return res.status(405).json({\n        success: false,\n        error: \"POST only\"\n    });\n    const { repoUrl } = req.body;\n    if (!repoUrl || typeof repoUrl !== \"string\") return res.status(400).json({\n        success: false,\n        error: \"repoUrl required\"\n    });\n    // temp dir\n    const tmp = path__WEBPACK_IMPORTED_MODULE_1___default().join(os__WEBPACK_IMPORTED_MODULE_0___default().tmpdir(), `keykite-${Date.now()}`);\n    const git = (0,simple_git__WEBPACK_IMPORTED_MODULE_3__.simpleGit)();\n    const findings = [];\n    try {\n        // Prepare clone URL: if GITHUB_TOKEN exists and repoUrl is github.com, use token to allow private clones\n        let cloneUrl = repoUrl;\n        const token = process.env.GITHUB_TOKEN;\n        const githubMatch = repoUrl.match(/https?:\\/\\/(github\\.com\\/.+)/i);\n        if (token && githubMatch) {\n            // embed token for cloning: https://<token>@github.com/owner/repo.git\n            // ensure .git suffix\n            const repoPath = githubMatch[1].replace(/^\\/?/, \"\");\n            const normalized = repoUrl.endsWith(\".git\") ? repoUrl : `https://github.com/${repoPath}.git`;\n            const u = new URL(normalized);\n            u.username = token;\n            cloneUrl = u.toString();\n        }\n        // clone shallow to temp dir\n        await git.clone(cloneUrl, tmp, [\n            \"--depth\",\n            \"1\"\n        ]);\n        // walk files, limit to relevant extensions\n        const files = walkDir(tmp, [\n            \".js\",\n            \".ts\",\n            \".jsx\",\n            \".tsx\",\n            \".env\",\n            \".json\",\n            \".py\",\n            \".go\",\n            \".rb\",\n            \".rs\",\n            \".java\",\n            \".sh\",\n            \".yaml\",\n            \".yml\",\n            \".md\"\n        ]);\n        const totalFiles = files.length;\n        let scanned = 0;\n        for (const file of files){\n            scanned++;\n            const content = (0,_utils_security__WEBPACK_IMPORTED_MODULE_4__.readFileSafe)(file);\n            if (!content) continue;\n            const fileFindings = (0,_utils_security__WEBPACK_IMPORTED_MODULE_4__.scanFile)(path__WEBPACK_IMPORTED_MODULE_1___default().relative(tmp, file), content);\n            // redact snippets in returned results (we already have redacted)\n            findings.push(...fileFindings);\n        }\n        // cleanup\n        try {\n            fs__WEBPACK_IMPORTED_MODULE_2___default().rmSync(tmp, {\n                recursive: true,\n                force: true\n            });\n        } catch (e) {}\n        return res.status(200).json({\n            success: true,\n            findings,\n            scanned,\n            totalFiles\n        });\n    } catch (err) {\n        // cleanup\n        try {\n            fs__WEBPACK_IMPORTED_MODULE_2___default().rmSync(tmp, {\n                recursive: true,\n                force: true\n            });\n        } catch (e) {}\n        const msg = err?.message || String(err);\n        return res.status(500).json({\n            success: false,\n            error: `Scan failed: ${msg}`\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvc2Nhbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUEsb0JBQW9CO0FBRUE7QUFDSTtBQUNKO0FBQ21CO0FBQ2dDO0FBSXZFLFNBQVNNLFFBQVFDLEdBQVcsRUFBRUMsT0FBaUIsRUFBRTtJQUMvQyxNQUFNQyxNQUFnQixFQUFFO0lBQ3hCLE1BQU1DLFFBQVFSLHFEQUFjLENBQUNLO0lBQzdCLEtBQUssTUFBTUssTUFBTUYsTUFBTztRQUN0QixNQUFNRyxPQUFPWixnREFBUyxDQUFDTSxLQUFLSztRQUM1QixJQUFJO1lBQ0YsTUFBTUcsS0FBS2Isa0RBQVcsQ0FBQ1c7WUFDdkIsSUFBSUUsR0FBR0UsV0FBVyxJQUFJO2dCQUNwQlIsSUFBSVMsSUFBSSxJQUFJWixRQUFRTyxNQUFNTDtZQUM1QixPQUFPLElBQUlPLEdBQUdJLE1BQU0sSUFBSTtnQkFDdEIsSUFBSVgsS0FBS1ksTUFBTSxLQUFLLEtBQUtaLEtBQUthLElBQUksQ0FBQ0MsQ0FBQUEsSUFBS1QsS0FBS1UsUUFBUSxDQUFDRCxLQUFLYixJQUFJUyxJQUFJLENBQUNMO1lBQ3RFO1FBQ0YsRUFBRSxPQUFPUyxHQUFHLENBQWU7SUFDN0I7SUFDQSxPQUFPYjtBQUNUO0FBRWUsZUFBZWUsUUFBUUMsR0FBbUIsRUFBRUMsR0FBMEI7SUFDbkYsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLFFBQVEsT0FBT0QsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztRQUFFQyxTQUFTO1FBQU9DLE9BQU87SUFBWTtJQUU1RixNQUFNLEVBQUVDLE9BQU8sRUFBRSxHQUFHUCxJQUFJUSxJQUFJO0lBQzVCLElBQUksQ0FBQ0QsV0FBVyxPQUFPQSxZQUFZLFVBQVUsT0FBT04sSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztRQUFFQyxTQUFTO1FBQU9DLE9BQU87SUFBbUI7SUFFckgsV0FBVztJQUNYLE1BQU1HLE1BQU1qQyxnREFBUyxDQUFDRCxnREFBUyxJQUFJLENBQUMsUUFBUSxFQUFFb0MsS0FBS0MsR0FBRyxHQUFHLENBQUM7SUFDMUQsTUFBTUMsTUFBTW5DLHFEQUFTQTtJQUNyQixNQUFNb0MsV0FBc0IsRUFBRTtJQUU5QixJQUFJO1FBQ0YseUdBQXlHO1FBQ3pHLElBQUlDLFdBQVdSO1FBQ2YsTUFBTVMsUUFBUUMsUUFBUUMsR0FBRyxDQUFDQyxZQUFZO1FBQ3RDLE1BQU1DLGNBQWNiLFFBQVFjLEtBQUssQ0FBQztRQUNsQyxJQUFJTCxTQUFTSSxhQUFhO1lBQ3hCLHFFQUFxRTtZQUNyRSxxQkFBcUI7WUFDckIsTUFBTUUsV0FBV0YsV0FBVyxDQUFDLEVBQUUsQ0FBQ0csT0FBTyxDQUFDLFFBQVE7WUFDaEQsTUFBTUMsYUFBYWpCLFFBQVFULFFBQVEsQ0FBQyxVQUFVUyxVQUFVLENBQUMsbUJBQW1CLEVBQUVlLFNBQVMsSUFBSSxDQUFDO1lBQzVGLE1BQU1HLElBQUksSUFBSUMsSUFBSUY7WUFDbEJDLEVBQUVFLFFBQVEsR0FBR1g7WUFDYkQsV0FBV1UsRUFBRUcsUUFBUTtRQUN2QjtRQUVBLDRCQUE0QjtRQUM1QixNQUFNZixJQUFJZ0IsS0FBSyxDQUFDZCxVQUFVTixLQUFLO1lBQUM7WUFBVztTQUFJO1FBQy9DLDJDQUEyQztRQUMzQyxNQUFNcUIsUUFBUWpELFFBQVE0QixLQUFLO1lBQUM7WUFBTztZQUFPO1lBQVE7WUFBUTtZQUFRO1lBQVM7WUFBTztZQUFPO1lBQU87WUFBTztZQUFTO1lBQU87WUFBUztZQUFRO1NBQU07UUFDOUksTUFBTXNCLGFBQWFELE1BQU1uQyxNQUFNO1FBQy9CLElBQUlxQyxVQUFVO1FBRWQsS0FBSyxNQUFNQyxRQUFRSCxNQUFPO1lBQ3hCRTtZQUNBLE1BQU1FLFVBQVV0RCw2REFBWUEsQ0FBQ3FEO1lBQzdCLElBQUksQ0FBQ0MsU0FBUztZQUNkLE1BQU1DLGVBQWV4RCx5REFBUUEsQ0FBQ0gsb0RBQWEsQ0FBQ2lDLEtBQUt3QixPQUFPQztZQUN4RCxpRUFBaUU7WUFDakVwQixTQUFTckIsSUFBSSxJQUFJMEM7UUFDbkI7UUFFQSxVQUFVO1FBQ1YsSUFBSTtZQUFFMUQsZ0RBQVMsQ0FBQ2dDLEtBQUs7Z0JBQUU2QixXQUFXO2dCQUFNQyxPQUFPO1lBQUs7UUFBSSxFQUFFLE9BQU8xQyxHQUFHLENBQWU7UUFFbkYsT0FBT0ksSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxTQUFTO1lBQU1TO1lBQVVrQjtZQUFTRDtRQUFXO0lBQzdFLEVBQUUsT0FBT1MsS0FBVTtRQUNqQixVQUFVO1FBQ1YsSUFBSTtZQUFFL0QsZ0RBQVMsQ0FBQ2dDLEtBQUs7Z0JBQUU2QixXQUFXO2dCQUFNQyxPQUFPO1lBQUs7UUFBSSxFQUFFLE9BQU8xQyxHQUFHLENBQWU7UUFDbkYsTUFBTTRDLE1BQU1ELEtBQUtFLFdBQVdDLE9BQU9IO1FBQ25DLE9BQU92QyxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLFNBQVM7WUFBT0MsT0FBTyxDQUFDLGFBQWEsRUFBRW1DLElBQUksQ0FBQztRQUFDO0lBQzdFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9rZXlraXRlLy4vcGFnZXMvYXBpL3NjYW4udHM/NWJkMyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBwYWdlcy9hcGkvc2Nhbi50c1xyXG5pbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tIFwibmV4dFwiO1xyXG5pbXBvcnQgb3MgZnJvbSBcIm9zXCI7XHJcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XHJcbmltcG9ydCBmcyBmcm9tIFwiZnNcIjtcclxuaW1wb3J0IHsgc2ltcGxlR2l0IH0gZnJvbSBcInNpbXBsZS1naXRcIjtcclxuaW1wb3J0IHsgc2NhbkZpbGUsIHJlYWRGaWxlU2FmZSwgRmluZGluZyB9IGZyb20gXCIuLi8uLi91dGlscy9zZWN1cml0eVwiO1xyXG5cclxudHlwZSBSZXNwID0geyBzdWNjZXNzOiB0cnVlOyBmaW5kaW5nczogRmluZGluZ1tdOyBzY2FubmVkOiBudW1iZXI7IHRvdGFsRmlsZXM6IG51bWJlciB9IHwgeyBzdWNjZXNzOiBmYWxzZTsgZXJyb3I6IHN0cmluZyB9O1xyXG5cclxuZnVuY3Rpb24gd2Fsa0RpcihkaXI6IHN0cmluZywgZXh0czogc3RyaW5nW10gPSBbXSk6IHN0cmluZ1tdIHtcclxuICBjb25zdCBvdXQ6IHN0cmluZ1tdID0gW107XHJcbiAgY29uc3QgaXRlbXMgPSBmcy5yZWFkZGlyU3luYyhkaXIpO1xyXG4gIGZvciAoY29uc3QgaXQgb2YgaXRlbXMpIHtcclxuICAgIGNvbnN0IGZ1bGwgPSBwYXRoLmpvaW4oZGlyLCBpdCk7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzdCA9IGZzLnN0YXRTeW5jKGZ1bGwpO1xyXG4gICAgICBpZiAoc3QuaXNEaXJlY3RvcnkoKSkge1xyXG4gICAgICAgIG91dC5wdXNoKC4uLndhbGtEaXIoZnVsbCwgZXh0cykpO1xyXG4gICAgICB9IGVsc2UgaWYgKHN0LmlzRmlsZSgpKSB7XHJcbiAgICAgICAgaWYgKGV4dHMubGVuZ3RoID09PSAwIHx8IGV4dHMuc29tZShlID0+IGZ1bGwuZW5kc1dpdGgoZSkpKSBvdXQucHVzaChmdWxsKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkgeyAvKiBpZ25vcmUgKi8gfVxyXG4gIH1cclxuICByZXR1cm4gb3V0O1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlPFJlc3A+KSB7XHJcbiAgaWYgKHJlcS5tZXRob2QgIT09IFwiUE9TVFwiKSByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiUE9TVCBvbmx5XCIgfSk7XHJcblxyXG4gIGNvbnN0IHsgcmVwb1VybCB9ID0gcmVxLmJvZHk7XHJcbiAgaWYgKCFyZXBvVXJsIHx8IHR5cGVvZiByZXBvVXJsICE9PSBcInN0cmluZ1wiKSByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwicmVwb1VybCByZXF1aXJlZFwiIH0pO1xyXG5cclxuICAvLyB0ZW1wIGRpclxyXG4gIGNvbnN0IHRtcCA9IHBhdGguam9pbihvcy50bXBkaXIoKSwgYGtleWtpdGUtJHtEYXRlLm5vdygpfWApO1xyXG4gIGNvbnN0IGdpdCA9IHNpbXBsZUdpdCgpO1xyXG4gIGNvbnN0IGZpbmRpbmdzOiBGaW5kaW5nW10gPSBbXTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIC8vIFByZXBhcmUgY2xvbmUgVVJMOiBpZiBHSVRIVUJfVE9LRU4gZXhpc3RzIGFuZCByZXBvVXJsIGlzIGdpdGh1Yi5jb20sIHVzZSB0b2tlbiB0byBhbGxvdyBwcml2YXRlIGNsb25lc1xyXG4gICAgbGV0IGNsb25lVXJsID0gcmVwb1VybDtcclxuICAgIGNvbnN0IHRva2VuID0gcHJvY2Vzcy5lbnYuR0lUSFVCX1RPS0VOO1xyXG4gICAgY29uc3QgZ2l0aHViTWF0Y2ggPSByZXBvVXJsLm1hdGNoKC9odHRwcz86XFwvXFwvKGdpdGh1YlxcLmNvbVxcLy4rKS9pKTtcclxuICAgIGlmICh0b2tlbiAmJiBnaXRodWJNYXRjaCkge1xyXG4gICAgICAvLyBlbWJlZCB0b2tlbiBmb3IgY2xvbmluZzogaHR0cHM6Ly88dG9rZW4+QGdpdGh1Yi5jb20vb3duZXIvcmVwby5naXRcclxuICAgICAgLy8gZW5zdXJlIC5naXQgc3VmZml4XHJcbiAgICAgIGNvbnN0IHJlcG9QYXRoID0gZ2l0aHViTWF0Y2hbMV0ucmVwbGFjZSgvXlxcLz8vLCBcIlwiKTtcclxuICAgICAgY29uc3Qgbm9ybWFsaXplZCA9IHJlcG9VcmwuZW5kc1dpdGgoXCIuZ2l0XCIpID8gcmVwb1VybCA6IGBodHRwczovL2dpdGh1Yi5jb20vJHtyZXBvUGF0aH0uZ2l0YDtcclxuICAgICAgY29uc3QgdSA9IG5ldyBVUkwobm9ybWFsaXplZCk7XHJcbiAgICAgIHUudXNlcm5hbWUgPSB0b2tlbjtcclxuICAgICAgY2xvbmVVcmwgPSB1LnRvU3RyaW5nKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gY2xvbmUgc2hhbGxvdyB0byB0ZW1wIGRpclxyXG4gICAgYXdhaXQgZ2l0LmNsb25lKGNsb25lVXJsLCB0bXAsIFsnLS1kZXB0aCcsICcxJ10pO1xyXG4gICAgLy8gd2FsayBmaWxlcywgbGltaXQgdG8gcmVsZXZhbnQgZXh0ZW5zaW9uc1xyXG4gICAgY29uc3QgZmlsZXMgPSB3YWxrRGlyKHRtcCwgWycuanMnLCAnLnRzJywgJy5qc3gnLCAnLnRzeCcsICcuZW52JywgJy5qc29uJywgJy5weScsICcuZ28nLCAnLnJiJywgJy5ycycsICcuamF2YScsICcuc2gnLCAnLnlhbWwnLCAnLnltbCcsICcubWQnXSk7XHJcbiAgICBjb25zdCB0b3RhbEZpbGVzID0gZmlsZXMubGVuZ3RoO1xyXG4gICAgbGV0IHNjYW5uZWQgPSAwO1xyXG5cclxuICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xyXG4gICAgICBzY2FubmVkKys7XHJcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSByZWFkRmlsZVNhZmUoZmlsZSk7XHJcbiAgICAgIGlmICghY29udGVudCkgY29udGludWU7XHJcbiAgICAgIGNvbnN0IGZpbGVGaW5kaW5ncyA9IHNjYW5GaWxlKHBhdGgucmVsYXRpdmUodG1wLCBmaWxlKSwgY29udGVudCk7XHJcbiAgICAgIC8vIHJlZGFjdCBzbmlwcGV0cyBpbiByZXR1cm5lZCByZXN1bHRzICh3ZSBhbHJlYWR5IGhhdmUgcmVkYWN0ZWQpXHJcbiAgICAgIGZpbmRpbmdzLnB1c2goLi4uZmlsZUZpbmRpbmdzKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBjbGVhbnVwXHJcbiAgICB0cnkgeyBmcy5ybVN5bmModG1wLCB7IHJlY3Vyc2l2ZTogdHJ1ZSwgZm9yY2U6IHRydWUgfSk7IH0gY2F0Y2ggKGUpIHsgLyogaWdub3JlICovIH1cclxuXHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBmaW5kaW5ncywgc2Nhbm5lZCwgdG90YWxGaWxlcyB9KTtcclxuICB9IGNhdGNoIChlcnI6IGFueSkge1xyXG4gICAgLy8gY2xlYW51cFxyXG4gICAgdHJ5IHsgZnMucm1TeW5jKHRtcCwgeyByZWN1cnNpdmU6IHRydWUsIGZvcmNlOiB0cnVlIH0pOyB9IGNhdGNoIChlKSB7IC8qIGlnbm9yZSAqLyB9XHJcbiAgICBjb25zdCBtc2cgPSBlcnI/Lm1lc3NhZ2UgfHwgU3RyaW5nKGVycik7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGBTY2FuIGZhaWxlZDogJHttc2d9YCB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIm9zIiwicGF0aCIsImZzIiwic2ltcGxlR2l0Iiwic2NhbkZpbGUiLCJyZWFkRmlsZVNhZmUiLCJ3YWxrRGlyIiwiZGlyIiwiZXh0cyIsIm91dCIsIml0ZW1zIiwicmVhZGRpclN5bmMiLCJpdCIsImZ1bGwiLCJqb2luIiwic3QiLCJzdGF0U3luYyIsImlzRGlyZWN0b3J5IiwicHVzaCIsImlzRmlsZSIsImxlbmd0aCIsInNvbWUiLCJlIiwiZW5kc1dpdGgiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsInJlcG9VcmwiLCJib2R5IiwidG1wIiwidG1wZGlyIiwiRGF0ZSIsIm5vdyIsImdpdCIsImZpbmRpbmdzIiwiY2xvbmVVcmwiLCJ0b2tlbiIsInByb2Nlc3MiLCJlbnYiLCJHSVRIVUJfVE9LRU4iLCJnaXRodWJNYXRjaCIsIm1hdGNoIiwicmVwb1BhdGgiLCJyZXBsYWNlIiwibm9ybWFsaXplZCIsInUiLCJVUkwiLCJ1c2VybmFtZSIsInRvU3RyaW5nIiwiY2xvbmUiLCJmaWxlcyIsInRvdGFsRmlsZXMiLCJzY2FubmVkIiwiZmlsZSIsImNvbnRlbnQiLCJmaWxlRmluZGluZ3MiLCJyZWxhdGl2ZSIsInJtU3luYyIsInJlY3Vyc2l2ZSIsImZvcmNlIiwiZXJyIiwibXNnIiwibWVzc2FnZSIsIlN0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/scan.ts\n");

/***/ }),

/***/ "(api)/./utils/security.ts":
/*!***************************!*\
  !*** ./utils/security.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isText: () => (/* binding */ isText),\n/* harmony export */   readFileSafe: () => (/* binding */ readFileSafe),\n/* harmony export */   redact: () => (/* binding */ redact),\n/* harmony export */   scanFile: () => (/* binding */ scanFile),\n/* harmony export */   shannonEntropy: () => (/* binding */ shannonEntropy)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n// utils/security.ts\n\nconst PATTERNS = [\n    {\n        type: \"AWS Access Key\",\n        regex: /AKIA[0-9A-Z]{16}/g\n    },\n    {\n        type: \"Google API Key\",\n        regex: /AIza[0-9A-Za-z-_]{35}/g\n    },\n    {\n        type: \"GitHub PAT-like\",\n        regex: /gh[pousr]_[0-9A-Za-z_]{36}/g\n    },\n    {\n        type: \"Generic API Key (var)\",\n        regex: /api[_-]?key\\s*[:=]\\s*['\"]?([A-Za-z0-9\\-_]+)['\"]?/gi\n    },\n    {\n        type: \"JWT\",\n        regex: /eyJ[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_.+/=]*/g\n    },\n    {\n        type: \"Password var\",\n        regex: /password\\s*[:=]\\s*['\"].+?['\"]/gi\n    },\n    {\n        type: \"Private Key PEM\",\n        regex: /-----BEGIN (?:RSA |ENCRYPTED )?PRIVATE KEY-----/g\n    }\n];\nfunction isText(content) {\n    const s = typeof content === \"string\" ? content : content.toString(\"utf8\", 0, Math.min(64, content.length));\n    // if it has NULs or many control chars, treat as binary\n    if (/[\\x00]/.test(s)) return false;\n    const controlChars = s.replace(/[\\r\\n\\t]/g, \"\").split(\"\").filter((c)=>c.charCodeAt(0) < 32).length;\n    return controlChars / Math.max(1, s.length) < 0.3;\n}\nfunction shannonEntropy(s) {\n    if (!s) return 0;\n    const freq = {};\n    for (const ch of s)freq[ch] = (freq[ch] || 0) + 1;\n    let ent = 0;\n    const len = s.length;\n    for(const k in freq){\n        const p = freq[k] / len;\n        ent -= p * Math.log2(p);\n    }\n    return ent;\n}\nfunction redact(s) {\n    if (!s) return \"[REDACTED]\";\n    if (s.length <= 6) return \"[REDACTED]\";\n    return s.slice(0, 4) + \"...\" + s.slice(-4);\n}\nfunction scanFile(filePath, content) {\n    const res = [];\n    if (typeof content !== \"string\") content = String(content);\n    const lines = content.split(/\\r?\\n/);\n    lines.forEach((line, idx)=>{\n        for (const p of PATTERNS){\n            let m;\n            const regex = new RegExp(p.regex);\n            // run global matches on the line\n            while((m = regex.exec(line)) !== null){\n                const raw = m[0];\n                const entropy = shannonEntropy(raw);\n                res.push({\n                    file: filePath,\n                    line: idx + 1,\n                    type: p.type,\n                    snippet: raw,\n                    entropy,\n                    redacted: redact(raw)\n                });\n                if (regex.lastIndex === m.index) regex.lastIndex++;\n            }\n        }\n    });\n    return res;\n}\n// helper: read file safely (skip if too big)\nfunction readFileSafe(path, maxBytes = 1024 * 1024) {\n    try {\n        const stat = fs__WEBPACK_IMPORTED_MODULE_0___default().statSync(path);\n        if (stat.size > maxBytes) return null;\n        const buf = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(path);\n        if (!isText(buf)) return null;\n        return buf.toString(\"utf8\");\n    } catch (e) {\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T2Y7QUFDVDtBQUVBLDZDQUE2QztBQUN0QyxTQUFTaUIsYUFBYUMsSUFBWSxFQUFFQyxXQUFXLE9BQU8sSUFBSTtJQUMvRCxJQUFJO1FBQ0YsTUFBTUMsT0FBT25ELGtEQUFXLENBQUNpRDtRQUN6QixJQUFJRSxLQUFLRSxJQUFJLEdBQUdILFVBQVUsT0FBTztRQUNqQyxNQUFNSSxNQUFNdEQsc0RBQWUsQ0FBQ2lEO1FBQzVCLElBQUksQ0FBQzdDLE9BQU9rRCxNQUFNLE9BQU87UUFDekIsT0FBT0EsSUFBSS9DLFFBQVEsQ0FBQztJQUN0QixFQUFFLE9BQU9pRCxHQUFHO1FBQ1YsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9rZXlraXRlLy4vdXRpbHMvc2VjdXJpdHkudHM/OTkxMCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB1dGlscy9zZWN1cml0eS50c1xyXG5pbXBvcnQgZnMgZnJvbSBcImZzXCI7XHJcblxyXG5leHBvcnQgdHlwZSBGaW5kaW5nID0ge1xyXG4gIGZpbGU6IHN0cmluZztcclxuICBsaW5lOiBudW1iZXI7XHJcbiAgdHlwZTogc3RyaW5nO1xyXG4gIHNuaXBwZXQ6IHN0cmluZztcclxuICBlbnRyb3B5PzogbnVtYmVyO1xyXG4gIHJlZGFjdGVkPzogc3RyaW5nO1xyXG59O1xyXG5cclxuY29uc3QgUEFUVEVSTlM6IHsgdHlwZTogc3RyaW5nOyByZWdleDogUmVnRXhwIH1bXSA9IFtcclxuICB7IHR5cGU6IFwiQVdTIEFjY2VzcyBLZXlcIiwgcmVnZXg6IC9BS0lBWzAtOUEtWl17MTZ9L2cgfSxcclxuICB7IHR5cGU6IFwiR29vZ2xlIEFQSSBLZXlcIiwgcmVnZXg6IC9BSXphWzAtOUEtWmEtei1fXXszNX0vZyB9LFxyXG4gIHsgdHlwZTogXCJHaXRIdWIgUEFULWxpa2VcIiwgcmVnZXg6IC9naFtwb3Vzcl1fWzAtOUEtWmEtel9dezM2fS9nIH0sXHJcbiAgeyB0eXBlOiBcIkdlbmVyaWMgQVBJIEtleSAodmFyKVwiLCByZWdleDogL2FwaVtfLV0/a2V5XFxzKls6PV1cXHMqWydcIl0/KFtBLVphLXowLTlcXC1fXSspWydcIl0/L2dpIH0sXHJcbiAgeyB0eXBlOiBcIkpXVFwiLCByZWdleDogL2V5SltBLVphLXowLTktX10rXFwuW0EtWmEtejAtOS1fXStcXC5bQS1aYS16MC05LV8uKy89XSovZyB9LFxyXG4gIHsgdHlwZTogXCJQYXNzd29yZCB2YXJcIiwgcmVnZXg6IC9wYXNzd29yZFxccypbOj1dXFxzKlsnXCJdLis/WydcIl0vZ2kgfSxcclxuICB7IHR5cGU6IFwiUHJpdmF0ZSBLZXkgUEVNXCIsIHJlZ2V4OiAvLS0tLS1CRUdJTiAoPzpSU0EgfEVOQ1JZUFRFRCApP1BSSVZBVEUgS0VZLS0tLS0vZyB9XHJcbl07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNUZXh0KGNvbnRlbnQ6IEJ1ZmZlciB8IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IHMgPSB0eXBlb2YgY29udGVudCA9PT0gXCJzdHJpbmdcIiA/IGNvbnRlbnQgOiBjb250ZW50LnRvU3RyaW5nKFwidXRmOFwiLCAwLCBNYXRoLm1pbig2NCwgY29udGVudC5sZW5ndGgpKTtcclxuICAvLyBpZiBpdCBoYXMgTlVMcyBvciBtYW55IGNvbnRyb2wgY2hhcnMsIHRyZWF0IGFzIGJpbmFyeVxyXG4gIGlmICgvW1xceDAwXS8udGVzdChzKSkgcmV0dXJuIGZhbHNlO1xyXG4gIGNvbnN0IGNvbnRyb2xDaGFycyA9IHMucmVwbGFjZSgvW1xcclxcblxcdF0vZywgXCJcIikuc3BsaXQoXCJcIikuZmlsdGVyKGMgPT4gYy5jaGFyQ29kZUF0KDApIDwgMzIpLmxlbmd0aDtcclxuICByZXR1cm4gY29udHJvbENoYXJzIC8gTWF0aC5tYXgoMSwgcy5sZW5ndGgpIDwgMC4zO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2hhbm5vbkVudHJvcHkoczogc3RyaW5nKTogbnVtYmVyIHtcclxuICBpZiAoIXMpIHJldHVybiAwO1xyXG4gIGNvbnN0IGZyZXE6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcclxuICBmb3IgKGNvbnN0IGNoIG9mIHMpIGZyZXFbY2hdID0gKGZyZXFbY2hdIHx8IDApICsgMTtcclxuICBsZXQgZW50ID0gMDtcclxuICBjb25zdCBsZW4gPSBzLmxlbmd0aDtcclxuICBmb3IgKGNvbnN0IGsgaW4gZnJlcSkge1xyXG4gICAgY29uc3QgcCA9IGZyZXFba10gLyBsZW47XHJcbiAgICBlbnQgLT0gcCAqIE1hdGgubG9nMihwKTtcclxuICB9XHJcbiAgcmV0dXJuIGVudDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlZGFjdChzOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGlmICghcykgcmV0dXJuIFwiW1JFREFDVEVEXVwiO1xyXG4gIGlmIChzLmxlbmd0aCA8PSA2KSByZXR1cm4gXCJbUkVEQUNURURdXCI7XHJcbiAgcmV0dXJuIHMuc2xpY2UoMCwgNCkgKyBcIi4uLlwiICsgcy5zbGljZSgtNCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzY2FuRmlsZShmaWxlUGF0aDogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpOiBGaW5kaW5nW10ge1xyXG4gIGNvbnN0IHJlczogRmluZGluZ1tdID0gW107XHJcbiAgaWYgKHR5cGVvZiBjb250ZW50ICE9PSBcInN0cmluZ1wiKSBjb250ZW50ID0gU3RyaW5nKGNvbnRlbnQpO1xyXG4gIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgvXFxyP1xcbi8pO1xyXG4gIGxpbmVzLmZvckVhY2goKGxpbmUsIGlkeCkgPT4ge1xyXG4gICAgZm9yIChjb25zdCBwIG9mIFBBVFRFUk5TKSB7XHJcbiAgICAgIGxldCBtOiBSZWdFeHBFeGVjQXJyYXkgfCBudWxsO1xyXG4gICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocC5yZWdleCk7XHJcbiAgICAgIC8vIHJ1biBnbG9iYWwgbWF0Y2hlcyBvbiB0aGUgbGluZVxyXG4gICAgICB3aGlsZSAoKG0gPSByZWdleC5leGVjKGxpbmUpKSAhPT0gbnVsbCkge1xyXG4gICAgICAgIGNvbnN0IHJhdyA9IG1bMF07XHJcbiAgICAgICAgY29uc3QgZW50cm9weSA9IHNoYW5ub25FbnRyb3B5KHJhdyk7XHJcbiAgICAgICAgcmVzLnB1c2goe1xyXG4gICAgICAgICAgZmlsZTogZmlsZVBhdGgsXHJcbiAgICAgICAgICBsaW5lOiBpZHggKyAxLFxyXG4gICAgICAgICAgdHlwZTogcC50eXBlLFxyXG4gICAgICAgICAgc25pcHBldDogcmF3LFxyXG4gICAgICAgICAgZW50cm9weSxcclxuICAgICAgICAgIHJlZGFjdGVkOiByZWRhY3QocmF3KVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChyZWdleC5sYXN0SW5kZXggPT09IG0uaW5kZXgpIHJlZ2V4Lmxhc3RJbmRleCsrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgcmV0dXJuIHJlcztcclxufVxyXG5cclxuLy8gaGVscGVyOiByZWFkIGZpbGUgc2FmZWx5IChza2lwIGlmIHRvbyBiaWcpXHJcbmV4cG9ydCBmdW5jdGlvbiByZWFkRmlsZVNhZmUocGF0aDogc3RyaW5nLCBtYXhCeXRlcyA9IDEwMjQgKiAxMDI0KTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN0YXQgPSBmcy5zdGF0U3luYyhwYXRoKTtcclxuICAgIGlmIChzdGF0LnNpemUgPiBtYXhCeXRlcykgcmV0dXJuIG51bGw7XHJcbiAgICBjb25zdCBidWYgPSBmcy5yZWFkRmlsZVN5bmMocGF0aCk7XHJcbiAgICBpZiAoIWlzVGV4dChidWYpKSByZXR1cm4gbnVsbDtcclxuICAgIHJldHVybiBidWYudG9TdHJpbmcoXCJ1dGY4XCIpO1xyXG4gIH0gY2F0Y2ggKGUpIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiZnMiLCJQQVRURVJOUyIsInR5cGUiLCJyZWdleCIsImlzVGV4dCIsImNvbnRlbnQiLCJzIiwidG9TdHJpbmciLCJNYXRoIiwibWluIiwibGVuZ3RoIiwidGVzdCIsImNvbnRyb2xDaGFycyIsInJlcGxhY2UiLCJzcGxpdCIsImZpbHRlciIsImMiLCJjaGFyQ29kZUF0IiwibWF4Iiwic2hhbm5vbkVudHJvcHkiLCJmcmVxIiwiY2giLCJlbnQiLCJsZW4iLCJrIiwicCIsImxvZzIiLCJyZWRhY3QiLCJzbGljZSIsInNjYW5GaWxlIiwiZmlsZVBhdGgiLCJyZXMiLCJTdHJpbmciLCJsaW5lcyIsImZvckVhY2giLCJsaW5lIiwiaWR4IiwibSIsIlJlZ0V4cCIsImV4ZWMiLCJyYXciLCJlbnRyb3B5IiwicHVzaCIsImZpbGUiLCJzbmlwcGV0IiwicmVkYWN0ZWQiLCJsYXN0SW5kZXgiLCJpbmRleCIsInJlYWRGaWxlU2FmZSIsInBhdGgiLCJtYXhCeXRlcyIsInN0YXQiLCJzdGF0U3luYyIsInNpemUiLCJidWYiLCJyZWFkRmlsZVN5bmMiLCJlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./utils/security.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fscan&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cscan.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();